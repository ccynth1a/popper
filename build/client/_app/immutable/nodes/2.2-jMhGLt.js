import{a as N,t as S,c as Y}from"../chunks/disclose-version.D7wIUWpV.js";import{n as ye,H as Ne,l as T,x as $,m as Se,G as Te,af as _e,M as ke,N as oe,O as K,w as R,I as me,J as he,K as Ie,ap as U,al as Ae,q as le,aq as W,ar as ve,as as Z,at as Ce,a1 as De,A as ce,au as Le,ae as Me,av as He,aw as Re,ax as pe,o as Oe,ab as Pe,ay as qe,a9 as Be,p as z,az as L,C as k,t as q,g as y,i as F,ao as M,j as x,k as E,s as G,h as X}from"../chunks/runtime.DhmC-uA-.js";import{d as ge,a as P}from"../chunks/store.D_znqWxX.js";import{a as C,o as j,i as O,p as de}from"../chunks/index-client.BBu5dIgR.js";import{i as Ge}from"../chunks/lifecycle.APe1pzaM.js";let Q=null;function be(t,e){return e}function ze(t,e,a,r){for(var d=[],u=e.length,o=0;o<u;o++)Le(e[o].e,d,!0);var m=u>0&&d.length===0&&a!==null;if(m){var p=a.parentNode;Me(p),p.append(a),r.clear(),A(t,e[0].prev,e[u-1].next)}He(d,()=>{for(var g=0;g<u;g++){var h=e[g];m||(r.delete(h.k),A(t,h.prev,h.next)),Re(h.e,!m)}})}function ee(t,e,a,r,d,u=null){var o=t,m={flags:e,items:new Map,first:null},p=(e&pe)!==0;if(p){var g=t;o=T?$(Oe(g)):g.appendChild(ye())}T&&Se();var h=null,v=!1;Ne(()=>{var l=a(),i=Te(l)?l:l==null?[]:_e(l),c=i.length;if(v&&c===0)return;v=c===0;let n=!1;if(T){var f=o.data===ke;f!==(c===0)&&(o=oe(),$(o),K(!1),n=!0)}if(T){for(var w=null,b,s=0;s<c;s++){if(R.nodeType===8&&R.data===Pe){o=R,n=!0,K(!1);break}var _=i[s],D=r(_,s);b=Ee(R,m,w,null,_,D,s,d,e),m.items.set(D,b),w=b}c>0&&$(oe())}T||Fe(i,m,o,d,e,r),u!==null&&(c===0?h?me(h):h=he(()=>u(o)):h!==null&&Ie(h,()=>{h=null})),n&&K(!0),a()}),T&&(o=R)}function Fe(t,e,a,r,d,u){var te,re,ne,ie;var o=(d&qe)!==0,m=(d&(W|Z))!==0,p=t.length,g=e.items,h=e.first,v=h,l,i=null,c,n=[],f=[],w,b,s,_;if(o)for(_=0;_<p;_+=1)w=t[_],b=u(w,_),s=g.get(b),s!==void 0&&((te=s.a)==null||te.measure(),(c??(c=new Set)).add(s));for(_=0;_<p;_+=1){if(w=t[_],b=u(w,_),s=g.get(b),s===void 0){var D=v?v.e.nodes_start:a;i=Ee(D,e,i,i===null?e.first:i.next,w,b,_,r,d),g.set(b,i),n=[],f=[],v=i.next;continue}if(m&&Je(s,w,_,d),s.e.f&U&&(me(s.e),o&&((re=s.a)==null||re.unfix(),(c??(c=new Set)).delete(s))),s!==v){if(l!==void 0&&l.has(s)){if(n.length<f.length){var B=f[0],I;i=B.prev;var ae=n[0],J=n[n.length-1];for(I=0;I<n.length;I+=1)ue(n[I],B,a);for(I=0;I<f.length;I+=1)l.delete(f[I]);A(e,ae.prev,J.next),A(e,i,ae),A(e,J,B),v=B,i=J,_-=1,n=[],f=[]}else l.delete(s),ue(s,v,a),A(e,s.prev,s.next),A(e,s,i===null?e.first:i.next),A(e,i,s),i=s;continue}for(n=[],f=[];v!==null&&v.k!==b;)v.e.f&U||(l??(l=new Set)).add(v),f.push(v),v=v.next;if(v===null)continue;s=v}n.push(s),i=s,v=s.next}if(v!==null||l!==void 0){for(var H=l===void 0?[]:_e(l);v!==null;)v.e.f&U||H.push(v),v=v.next;var V=H.length;if(V>0){var xe=d&pe&&p===0?a:null;if(o){for(_=0;_<V;_+=1)(ne=H[_].a)==null||ne.measure();for(_=0;_<V;_+=1)(ie=H[_].a)==null||ie.fix()}ze(e,H,xe,g)}}o&&Ae(()=>{var se;if(c!==void 0)for(s of c)(se=s.a)==null||se.apply()}),le.first=e.first&&e.first.e,le.last=i&&i.e}function Je(t,e,a,r){r&W&&ve(t.v,e),r&Z?ve(t.i,a):t.i=a}function Ee(t,e,a,r,d,u,o,m,p){var g=Q;try{var h=(p&W)!==0,v=(p&Ce)===0,l=h?v?De(d):ce(d):d,i=p&Z?ce(o):o,c={i,v:l,k:u,a:null,e:null,prev:a,next:r};return Q=c,c.e=he(()=>m(t,l,i),T),c.e.prev=a&&a.e,c.e.next=r&&r.e,a===null?e.first=c:(a.next=c,a.e.next=c.e),r!==null&&(r.prev=c,r.e.prev=c.e),c}finally{Q=g}}function ue(t,e,a){for(var r=t.next?t.next.e.nodes_start:a,d=e?e.e.nodes_start:a,u=t.e.nodes_start;u!==r;){var o=Be(u);d.before(u),u=o}}function A(t,e,a){e===null?t.first=a:(e.next=a,e.e.next=a&&a.e),a!==null&&(a.prev=e,a.e.prev=e&&e.e)}function we(t,e){var a=t.__className,r=Ve(e);T&&t.className===r?t.__className=r:(a!==r||T&&t.className!==r)&&(e==null?t.removeAttribute("class"):t.className=r,t.__className=r)}function Ve(t){return t??""}async function Ye(t,e){return console.log(t),console.log(e),await(await fetch("/api/highscore",{method:"POST",body:JSON.stringify({user:t,score:e}),headers:{"content-type":"application/json"}})).json()}async function fe(){return await(await fetch("/api/highscore",{method:"GET",headers:{"content-type":"application/json"}})).json()}var $e=(t,e,a)=>e(y(a).id),Ke=S('<input type="button">'),Ue=S('<div class="grid"></div>'),Xe=S('<div class="countdown"><h1 class="counter"> </h1></div>'),Qe=S('<main class="theme-default popper-grid"><!></main>');function We(t,e){z(e,!0);let a=M(!1),r=M(3),d=C([]),u=Date.now(),o,m;const p=function(){for(let n=0;n<20;(n+=1)-1)d[n]={id:n,active:!1}},g=function(n){console.log(n),d[n].active?(d[n].active=!1,d.some(f=>f.active)||v(!0)):v(!1)},h=function(){let n=new Set;for(;n.size<=7;)n.add(Math.floor(Math.random()*20));for(const f of n)d[f].active=!0},v=function(n){n&&(o=Date.now(),m=o-u,Ye(e.username,m)),k(a,!1),d.forEach(f=>f.active=!1),h(),k(r,3),l(1e3).then(()=>{L(r,-1),l(1e3).then(()=>{L(r,-1),l(1e3).then(()=>{L(r,-1),k(a,!0)})})}),u=Date.now()},l=function(n){return new Promise(f=>setTimeout(f,n))};j(()=>{p(),h(),l(1e3).then(()=>{L(r,-1),l(1e3).then(()=>{L(r,-1),l(1e3).then(()=>{L(r,-1),k(a,!0)})})}),u=Date.now()});var i=Qe(),c=x(i);O(c,()=>y(a)||e.settings.countdown==!1,n=>{var f=Ue();ee(f,21,()=>d,be,(w,b)=>{var s=Ke();s.__click=[$e,g,b],q(()=>we(s,`circle ${(y(b).active?"active":"")??""}`)),N(w,s)}),E(f),N(n,f)},n=>{var f=Xe(),w=x(f),b=x(w,!0);E(w),E(f),q(()=>P(b,y(r))),N(n,f)}),E(i),N(t,i),F()}ge(["click"]);var Ze=S('<main class="theme-default leaderboarditem"><div class="container"><div id="container-left"><div id="position"> </div> <div id="username"> </div></div> <div id="container-right"><div id="score"> </div></div></div></main>');function je(t,e){z(e,!1);let a=de(e,"position",8),r=de(e,"score",8);const d=n=>(n/1e3).toFixed(3).toString().padStart(2,"0");Ge();var u=Ze(),o=x(u),m=x(o),p=x(m),g=x(p,!0);E(p);var h=G(p,2),v=x(h,!0);E(h),E(m);var l=G(m,2),i=x(l),c=x(i,!0);q(()=>P(c,d(r().score))),E(i),E(l),E(o),E(u),q(()=>{P(g,a()+1),P(v,r().username)}),N(t,u),F()}var ea=S('<main><div class="header-div"><h1>Leaderboard</h1></div></main>');function aa(t){var e=ea();N(t,e)}var ta=S('<main class="theme-default leaderboard"><!> <!></main>');function ra(t,e){z(e,!0);let a=M(C([]));j(()=>{fe().then(o=>{k(a,C(o))}),setInterval(()=>fe().then(o=>{k(a,C(o))}),1e3)});var r=ta(),d=x(r);aa(d);var u=G(d,2);ee(u,17,()=>y(a),be,(o,m,p)=>{je(o,{position:p,get score(){return y(m)}})}),E(r),N(t,r),F()}var na=S('<main class="theme-default settings"><div><h1>Settings</h1></div></main>');function ia(t){var e=na();N(t,e)}var sa=(t,e,a)=>{k(e,C(y(a).id))},oa=S("<button> </button>"),la=S('<div class="username-entry"><input type="text" id="username-entry-field"></div>'),va=S('<main class="theme-default popper-main-style"><div class="componentloader"><div class="nav"></div> <div class="container"><!></div></div></main>');function ca(t,e){z(e,!0);let a=M(0),r=C([{label:"Popper",id:0},{label:"Leaderboard",id:1},{label:"Settings",id:2}]),d=C({countdown:!0}),u=M(""),o=M(!1);j(()=>{let l=document.getElementById("username-entry-field");l.addEventListener("keyup",i=>{i.key==="Enter"&&(k(u,C(l.value)),k(o,!0))})});var m=va(),p=x(m),g=x(p);ee(g,21,()=>r,l=>l.id,(l,i)=>{var c=oa();c.__click=[sa,a,i];var n=x(c,!0);E(c),q(()=>{we(c,`navbutton ${(y(a)==y(i).id?"active":"")??""} `),P(n,y(i).label)}),N(l,c)}),E(g);var h=G(g,2),v=x(h);O(v,()=>y(o),l=>{var i=Y(),c=X(i);O(c,()=>y(a)==0,n=>{We(n,{get username(){return y(u)},get settings(){return d}})},n=>{var f=Y(),w=X(f);O(w,()=>y(a)==1,b=>{ra(b,{})},b=>{var s=Y(),_=X(s);O(_,()=>y(a)==2,D=>{ia(D)},null,!0),N(b,s)},!0),N(n,f)}),N(l,i)},l=>{var i=la();N(l,i)}),E(h),E(p),E(m),N(t,m),F()}ge(["click"]);var da=S("<main><!></main>");function pa(t){var e=da(),a=x(e);ca(a,{}),E(e),N(t,e)}export{pa as component};
